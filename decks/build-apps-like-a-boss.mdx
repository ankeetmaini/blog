import { themes, Appear, Split, FullScreenCode, Image } from 'mdx-deck'
import Text from './components/Text.js'
import Graph from './components/ParodyGraph.js'
import Giphy from './components/Giphy'
import Progress from './components/Progress'
import Center from './components/CenterInline'


export const theme = {
  ...themes.book,
  colors: themes.dark.colors,
  Provider: Progress
}

# [**build app(s) plural - like a boss!**]()

ğŸ‘‹ friends! I'm <Text>**Ankeet Maini**</Text>

<Appear>
  <li>frontend engineer @Flipkart</li>
  <li>
    <Text>@ankeetmaini</Text> (twitter, github, instagram ğŸ¤­)
  </li>
</Appear>

---

Let's work our way through the usual workflow

<Appear>
  <li>you start creating an app</li>
  <li>done!</li>
  <div>
    <Giphy>https://media.giphy.com/media/Ut6Xbl4kfDcWc/giphy.gif</Giphy>
  </div>
</Appear>

---

Let's work our way through the ~~usual~~ **<Text>real</Text>** workflow

<Appear>
  <li>create a repository</li>
  <li>start writing code...</li>
  <div>
    <Giphy>https://media.giphy.com/media/Ut6Xbl4kfDcWc/giphy.gif</Giphy>
  </div>
</Appear>

---

Let's work our way through the ~~usual~~ ~~real~~ **<Text>actual</Text>** workflow

<li>âœ… create a repository</li>
<Appear>
  <li>setup ESLint</li>
  <li>
    latest research trend on ESLint{' '}
    <Text>(data gathered from Github commits all over the world)</Text>
    <sup>*</sup>
  </li>
  <li>...in the next slide</li>
</Appear>

---

<FullScreenCode>
  <Graph
    height={800}
    leftText="time taken"
    loser="entire app code"
    winner="ESLint"
    loserHeight={150}
    winnerHeight={830}
  />
</FullScreenCode>

---

Let's work our way through the ~~usual~~ ~~real~~ **<Text>actual</Text>** workflow

<li>create a repository</li>
<li>setup ESLint</li>
<Appear>
  <li>and if you use TypeScript</li>
  <div>
    <div style={{ marginLeft: 100 }}>- TSLint</div>
  </div>
  <div>
    <div style={{ marginLeft: 100 }}>- @typescript-eslint</div>
  </div>
  <div>
    <div style={{ marginLeft: 100 }}>- TSLint -> @typescript-eslint</div>
  </div>
</Appear>

---

Let's work our way through the ~~usual~~ ~~real~~ **<Text>actual</Text>** workflow

<li>âœ… create a repository</li>
<li>âœ… setup ESLint</li>
<Appear>
  <li>âœ… setup Prettier</li>
  <li>âœ… disable ESLint rules which collide with Prettier ğŸ¤£ğŸ¤£</li>
  <li>âœ… configure lint-staged</li>
  <li>âœ… configure TypeScript/Flow</li>
  <li>BUILD/BUNDLER setup - Webpack</li>
</Appear>

---

Let's work our way through the ~~usual~~ ~~real~~ **<Text>actual</Text>** workflow

<li>...</li>
<li>BUILD/BUNDLER setup - Webpack</li>
<Appear>
  <div>
    <div style={{ marginLeft: 100 }}>- babel</div>
  </div>
  <div>
    <div style={{ marginLeft: 100 }}>
      - directly ts-loader/awesome-typescript-loader
    </div>
  </div>
  <div>
    <div style={{ marginLeft: 100 }}>
      - ts-loader with `babel` and `babel-loader`
    </div>
  </div>
  <li>
    latest research trend on Webpack config{' '}
    <Text>(data gathered from Github commits all over the world)</Text>
    <sup>*</sup>
  </li>
</Appear>

---

<FullScreenCode>
  <Graph
    height={800}
    leftText="complexity"
    loser="quantum physics"
    winner="Webpack configs"
    loserHeight={350}
    winnerHeight={830}
  />
</FullScreenCode>

---

Let's work our way through the ~~usual~~ ~~real~~ **<Text>actual</Text>** workflow

<li>...</li>
<Appear>
  <li>unit test setup - jest</li>
  <li>e2e test setup - cypress/testcafe</li>
  <li>jenkins job pipelines</li>
  <li>deploy scripts</li>
  <li>ğŸ’†â€â™‚</li>
</Appear>

---

<div style={{ margin: -80 }}><Giphy>https://media.giphy.com/media/F458eKi7tpSqQ/giphy.gif</Giphy></div>

---

And if you think this was <Text>**enough**</Text>?

<Appear>
  <li>server infra</li>
  <li>deployment machines</li>
  <li>health checks</li>
  <li>ELBs/VIPs</li>
  <li>alerts</li>
  <li>...</li>
</Appear>

---

Mandatory digression:

What's your code sharing strategy?

---
<Text>I copy-paste whatever I need, wherever I need. #YOLO</Text>

<Appear>
  <div>
    <Giphy width={800}>https://media.giphy.com/media/iNJmdpZ8gp5sI/giphy.gif</Giphy>
  </div>
</Appear>

---
<FullScreenCode>
  <Text>npm publish everything</Text>
  <Appear>
    <div><img src="https://i.imgur.com/ZigwdOa.png"/></div>
    <div><img src="https://i.imgur.com/LwSA6oe.png"/></div>
  </Appear>
</FullScreenCode>

---

Back on track now :P

# My point?

<Appear>
  <li>non-trivial amount of effort for every new app</li>
  <li>new apps keep happening...</li>
  <li>difficult/tedious code sharing</li>
  <li>can it be done once and reused for all new apps?</li>
  <li>using the tools we already use?</li>
</Appear>

---

<div style={{ margin: -180 }}><Giphy>https://media.giphy.com/media/10yIEN8cMn4i9W/giphy.gif</Giphy></div>

---

Cram everything into a single repo
<Appear>  
  <div><Giphy width={800}>https://media.giphy.com/media/VR4Xdxj5MXDna/giphy.gif</Giphy></div>
  <div><Center><Text>Not like this friends ğŸ¤ª</Text></Center></div>
</Appear>

---

<li>have a clear simple folder structure which your team can converge on</li>
<Appear>
  <li>divide apps by different routes</li>
  <li><Text>What can go wrong??</Text></li>
</Appear>

---

<Text>Everything crammed together.</Text>

- works fine for 1 app
- works fine for 2 apps
- works fine for 10 apps
- it works until...you start seeing things :P

---

# <Text>Problems:</Text> Everything crammed together.

# one single bundle <Text>(easy-peasy to solve with code-splitting)</Text>

---

# <Text>Problems:</Text> Everything crammed together.
  
# change one app, all apps are built (even though individual hashes <Text>may</Text> remain unchanged)
<Appear>
  <div>
    <Giphy width={700}>https://media.giphy.com/media/LmeqXB5857G0E1vwDq/giphy.gif</Giphy>
    <Center>Webpack and remaining <Text>989,545,432,563 packages in node_modules</Text></Center>
  </div>
</Appear>

---

<FullScreenCode>
  Can't I create multiple entry points in webpack??? <Text>Duh!</Text>
  <Appear>
    <div>
      you won't be able to do cool stuff like this :P
      <Giphy>https://i.imgur.com/mk0n8L1.png</Giphy>    
    </div>
  </Appear>
</FullScreenCode>

---

# I wish there was a way to do this ğŸ’­ğŸ’­ğŸ’­

<Appear>
  <div><Text><Center>roses are red</Center></Text></div>
  <div><Text><Center>violets are blue</Center></Text></div>
  <div><Text><Center>isn't there a ...</Center></Text></div>
  <div><Text><Center>Webpack plugin which would do!</Center></Text></div>
  <h1><Center>Nooooooooooo! ğŸ˜­ğŸ˜­ğŸ˜­</Center></h1>
</Appear>

---

<Text>aim: selectively build an app</Text>
<ol>
  <Appear>
    <li>remove all hard-coded imports and routes from <Text>app.js</Text></li>
    <li>pass the app name while starting the app, which webpack reads and does some ğŸ©âœ¨ğŸ”®</li>
    <li>magic === a simple webpack loader that changes <Text>app.js</Text> just before bundling</li>
    <li>changing === adding the imports and route details</li>
    <li>voila!</li>
  </Appear>
</ol>

---

<Text>QRs and links!</Text>

- ![](https://i.imgur.com/3MnqKDT.png) 
- ![](https://i.imgur.com/zqCXTf1.png)
- https://github.com/ankeetmaini/multi-app-single-repo-example

---

<Giphy>https://media.giphy.com/media/3osxYdXvsGw6wT5lIY/giphy.gif</Giphy>

---

# valid tweet adjectives :P

<Giphy>https://i.imgur.com/Lq3AvBa.png</Giphy>
